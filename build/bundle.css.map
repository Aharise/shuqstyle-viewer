{
  "version": 3,
  "file": "bundle.css",
  "sources": [
    "../../Header.svelte",
    "../../ErrorMessage.svelte",
    "../../View.svelte"
  ],
  "sourcesContent": [
    "<script>\nimport { link } from \"svelte-routing\";\n\nexport let apiBase;\nexport let apikey;\n\nfunction enterApikey() {\n  if (apikey.length > 0) {\n    toggle_api_key_scrollin();\n  }\n}\n\nlet isSettingOpen = false;\n\nfunction toggle_api_key_scrollin() {\n  isSettingOpen && window.localStorage.setItem(\"apiBase\", apiBase);\n  isSettingOpen && window.localStorage.setItem(\"apikey\", apikey);\n  isSettingOpen = !isSettingOpen;\n}\n</script>\n\n<div id=\"api-key-scrollin\">\n  <div id=\"api-setting\" class:on={isSettingOpen}>\n    <form class=\"block shadow-sm text-align-left\" on:submit|preventDefault={enterApikey}>\n      <label>\n        API base\n        <input tye=\"text\" bind:value={apiBase} placeholder=\"https://api.pxl.ai/v1\">\n      </label>\n      <label>\n        API key\n        <input type=\"text\" id=\"input_apikey\" bind:value={apikey}>\n      </label>\n      <input type=\"submit\">\n    </form>\n  </div>\n</div>\n<div class=\"navbar\" id=\"navbar\">\n  <a href=\"/\" use:link>\n    <img src=\"/images/logo_pxl_b.png\" alt=\"PXL\">\n  </a>\n  <ul class=\"menu\">\n    <li><a class=\"button\" href=\"#\" on:click|preventDefault={toggle_api_key_scrollin} id=\"settings\"><i class=\"fas fa-cog\"></i></a></li>\n  </ul>\n</div>\n\n<style>\n#api-setting {\n  margin-top: -182px;\n  -webkit-transition: margin 0.4s;\n  transition: margin 0.4s;\n  padding: 20px;\n  text-align: left;\n}\n#api-setting.on {\n  margin: 0;\n}\n#api-setting form {\n  display: grid;\n  grid-template-columns: 400px 1fr;\n  grid-gap: 20px;\n}\n#api-setting label {\n  margin-bottom: 20px;\n  font-size: 14px;\n  font-weight: 600;\n  display: block;\n}\n#api-setting input {\n  width: 100%;\n  height: 40px;\n  padding: 10px;\n  margin-top: 20px;    \n  box-sizing: border-box;\n  font-size: 14px;\n  border: 1px solid #dcdcdc;\n  border-radius: 0;\n  -webkit-appearance: none;\n  color: #555;\n  font-weight: normal;\n}\n#api-setting input[type=submit] {\n  display: none;\n}\n\n.navbar {\n  padding: 20px;\n  overflow: auto;\n}\n@media (min-width: 480px) {\n  .navbar {\n    padding: 40px;\n  }\n}\n.navbar > a {\n  float: left;\n  display: inline-block;\n}\n.navbar > a > img {\n  height: 20px;\n  margin: 5px 0 5px 0;\n  vertical-align: middle;\n}\n@media (min-width: 480px) {\n  .navbar > a > img {\n    height: 30px;\n  }\n}\n.navbar > .menu {\n  float: right;\n  vertical-align: middle;\n}\n.navbar > ul {\n  margin: 0;\n  padding: 0;\n}\n.navbar > ul > li {    \n  margin-left: 20px;\n  padding: 0;\n  margin: 0;\n  border: none;\n  display: inline-block;\n  list-style: none;\n}\n.navbar > ul > li > .button {\n  line-height: 28px;\n  padding: 0 0 0 20px;\n  display: inline-block;\n  text-decoration: none;\n  border-radius: 100px;\n}\n@media (min-width: 480px) {\n  .navbar > ul > li > .button {\n    line-height: 40px;\n  }\n}\n.navbar > ul > li > .button > i {\n  font-size: 20px;\n}\n</style>\n",
    "<script>\nexport let errorMessage;\n\nfunction close() {\n  errorMessage = null;\n}\n</script>\n\n<div id=\"error-message\" class:on={errorMessage !== null}>\n  {errorMessage === null ? '' : errorMessage}\n  <button on:click={close}></button>\n</div>\n\n<style>\n#error-message {\n  position: fixed;\n  left: 0;\n  bottom: -80px;\n  width: 100%;\n  height: 80px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background: #fff;\n  box-shadow: 0 5px 30px 0 rgba(0, 0, 0, 0.1);\n  font-size: 14px;\n  transition: bottom 0.17s;\n  color: #c00;\n}\n#error-message.on {\n  bottom: 0;\n}\n#error-message button {\n  position: absolute;\n  top: 0;\n  right: 20px;\n  width: 80px;\n  height: 80px;\n  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkAQMAAADbzgrbAAAABlBMVEUAAABQUErlaWKlAAAAAXRSTlMAQObYZgAAAHFJREFUCNctj7ENwCAMBC+ioGSBSGwSRoNNsgqjMEJKCoSDeL6wELb/z0g3uMIDvpIhNHIhrlpJjbQf8cMKoV8GfrgJbvoBl4UO2PsB2RqQrAJxjUMwlvw8VT/qalJbcpCbnE+KEpUuElGJULQiP1ds/ShcPhc+rDecAAAAAElFTkSuQmCC) no-repeat 50% 50% / 18px 18px;\n  text-indent: -99em;\n  overflow: hidden;\n  border: 0 none;\n}\n</style>\n",
    "<script>\nimport { ONEPIECE, SKIRTS, CATEGORY, ATTRIBUTE, FLEX_MODE, DL_PROXY } from './constant.js';\nimport { onMount } from 'svelte';\nimport Detect from './Detect.svelte';\nimport TypeTab from './TypeTab.svelte';\nimport Filter from './Filter.svelte';\nimport ProductList from './ProductList.svelte';\n\nexport let location;\nexport let url;\nexport let pxl;\n\nlet current_result_type = 'search' || 'recommend' || 'recommend-multi';\nlet current_categories = undefined;\nlet current_gender = undefined;\nlet current_subcategory = undefined;\nlet current_region = undefined;\nlet current_attributes = undefined;\nlet flexmodeOption = 'filter';\n$: flexmode = FLEX_MODE[flexmodeOption];\nlet regions = [];\nlet analyze = [];\nlet image_url = url;\n$: if (url) {\n  render();\n};\n$: results = null;\nlet resultLoading = false;\n\nonMount(render);\n\nasync function render() {\n    image_url = decodeURIComponent(url);\n\n  var detection_cb = async function (results) {\n    if (results === null) {\n      return;\n    }\n\n    regions = results;\n    const bestRegion = regionArgMax(regions);\n    init_current_values(bestRegion);\n    change_region(bestRegion);\n\n    if (regions.length > 0 && bestRegion.id !== undefined && typeof bestRegion.id === 'string') {\n      var image_hash = bestRegion.id.split('_')[0];\n      analyze = await pxl.analyze(`https://img.pxl.ai/${image_hash}`);\n    }\n  };\n\n  detection_cb(await pxl.detect(image_url))\n}\n\n// https://github.com/ocsdk/shuqstyle-js-sdk/blob/master/pxl.js#L574\nfunction regionArgMax(l) {\n  // Favor big rectangles. The abs() call here is overkill, but I don't trust the data.\n  return argmax(l, (e) => {\n    const score = e.score || e.category.score;\n    return Math.abs(e.rx2 - e.rx1) * Math.abs(e.ry2 - e.ry1) * score\n  });\n}\n\n// https://github.com/ocsdk/shuqstyle-js-sdk/blob/master/pxl.js#L536\nfunction argmax(l, f) {\n  // FIXME: This should be made to work with NodeLists.\n  let ms = f(l[0]),\n      mo = l[0];\n\n  l.map((e) => {\n    let i = f(e);\n\n    if (i > ms) {\n      ms = i;\n      mo = e;\n    }\n  });\n\n  return mo;\n}\n\n  function change_region(region) {\n    init_current_values(region);\n\n    update_result();\n  }\n\nfunction update_type(event) {\n  const element = event.target;\n  const type = element.getAttribute('data-type');\n  current_result_type = type;\n  localStorage.setItem('current_result_type', type);\n  update_result();\n}\n\nfunction init_current_values(region) {\n  current_region = region;\n  current_gender = region.gender.code;\n  current_categories = [(region.category1 || region.category).code];\n  current_subcategory = undefined;\n  current_attributes = [];\n  flexmodeOption = 'filter';\n}\n\nfunction update_result() {\n  if (current_result_type === 'search') {\n    search(current_region, current_gender, current_categories, current_subcategory, current_attributes, flexmode);\n  } else if (current_result_type === 'recommend' || current_result_type === 'recommend-multi') {\n    recommend(current_region, current_gender, current_categories[0]);\n  }\n}\n\nasync function search(region, gender, categories, sub_category, attributes, flex_mode) {\n  var gendered_category = gender;\n\n  for (var i=0; i<categories.length; i++) {\n    gendered_category |= categories[i];\n  }\n\n  var flex_query = {};\n\n  if (sub_category !== undefined) {\n    flex_query[\"sub_category\"] = sub_category;\n  }\n\n  if (attributes && attributes.length > 0) {\n    flex_query[\"attributes\"] = attributes;\n  }\n\n  if (Object.keys(flex_query).length === 0) {\n    flex_query = undefined;\n  }\n  results = null;\n  resultLoading = true;\n  const r = await pxl.search(region, gender, gendered_category, flex_query, flex_mode, 34);\n  if (r !== null && r[parseInt(gendered_category)] !== undefined) { // v1 API\n    results = r[parseInt(gendered_category)];\n  } else {\n    results = r;\n  }\n  resultLoading = false;\n}\n\nasync function recommend(region, gender, category) {\n  var gendered_category = gender | category;\n  var mode = current_result_type === 'recommend' ? 1 : 2;\n  results = null;\n  resultLoading = true;\n  const r = await pxl.recommend(region, mode, gendered_category, 34);\n  results = r;\n  resultLoading = false;\n}\n</script>\n\n<div id=\"view\">\n  <Detect image_url={image_url} regions={regions} analyze={analyze} current_region={current_region} change_region={change_region} />\n  <TypeTab bind:type={current_result_type} click_tab={update_type} pxl={pxl} />\n  <Filter\n    type={current_result_type}\n    region={current_region}\n    bind:genderOption={current_gender}\n    bind:categoryOption={current_categories}\n    bind:subCategoryOption={current_subcategory}\n    bind:flexmodeOption={flexmodeOption}\n    onFilterChange={update_result} />\n  <ProductList json={results} resultLoading={resultLoading} />\n</div>\n\n<style>\n#view {\n  position: relative;\n}\n</style>\n"
  ],
  "names": [],
  "mappings": "AA8CA,YAAY,2EAAC,CAAC,AACZ,UAAU,CAAE,MAAM,CAClB,kBAAkB,CAAE,MAAM,CAAC,IAAI,CAC/B,UAAU,CAAE,MAAM,CAAC,IAAI,CACvB,OAAO,CAAE,IAAI,CACb,UAAU,CAAE,IAAI,AAClB,CAAC,AACD,YAAY,GAAG,2EAAC,CAAC,AACf,MAAM,CAAE,CAAC,AACX,CAAC,AACD,wEAAY,CAAC,IAAI,4DAAC,CAAC,AACjB,OAAO,CAAE,IAAI,CACb,qBAAqB,CAAE,KAAK,CAAC,GAAG,CAChC,QAAQ,CAAE,IAAI,AAChB,CAAC,AACD,wEAAY,CAAC,KAAK,4DAAC,CAAC,AAClB,aAAa,CAAE,IAAI,CACnB,SAAS,CAAE,IAAI,CACf,WAAW,CAAE,GAAG,CAChB,OAAO,CAAE,KAAK,AAChB,CAAC,AACD,wEAAY,CAAC,KAAK,4DAAC,CAAC,AAClB,KAAK,CAAE,IAAI,CACX,MAAM,CAAE,IAAI,CACZ,OAAO,CAAE,IAAI,CACb,UAAU,CAAE,IAAI,CAChB,UAAU,CAAE,UAAU,CACtB,SAAS,CAAE,IAAI,CACf,MAAM,CAAE,GAAG,CAAC,KAAK,CAAC,OAAO,CACzB,aAAa,CAAE,CAAC,CAChB,kBAAkB,CAAE,IAAI,CACxB,KAAK,CAAE,IAAI,CACX,WAAW,CAAE,MAAM,AACrB,CAAC,AACD,wEAAY,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,4DAAC,CAAC,AAC/B,OAAO,CAAE,IAAI,AACf,CAAC,AAED,OAAO,2EAAC,CAAC,AACP,OAAO,CAAE,IAAI,CACb,QAAQ,CAAE,IAAI,AAChB,CAAC,AACD,MAAM,AAAC,YAAY,KAAK,CAAC,AAAC,CAAC,AACzB,OAAO,2EAAC,CAAC,AACP,OAAO,CAAE,IAAI,AACf,CAAC,AACH,CAAC,AACD,mEAAO,CAAG,CAAC,4DAAC,CAAC,AACX,KAAK,CAAE,IAAI,CACX,OAAO,CAAE,YAAY,AACvB,CAAC,AACD,oDAAO,CAAG,8CAAC,CAAG,GAAG,6CAAC,CAAC,AACjB,MAAM,CAAE,IAAI,CACZ,MAAM,CAAE,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CACnB,cAAc,CAAE,MAAM,AACxB,CAAC,AACD,MAAM,AAAC,YAAY,KAAK,CAAC,AAAC,CAAC,AACzB,oDAAO,CAAG,8CAAC,CAAG,GAAG,6CAAC,CAAC,AACjB,MAAM,CAAE,IAAI,AACd,CAAC,AACH,CAAC,AACD,mEAAO,CAAG,KAAK,4DAAC,CAAC,AACf,KAAK,CAAE,KAAK,CACZ,cAAc,CAAE,MAAM,AACxB,CAAC,AACD,mEAAO,CAAG,EAAE,4DAAC,CAAC,AACZ,MAAM,CAAE,CAAC,CACT,OAAO,CAAE,CAAC,AACZ,CAAC,AACD,oDAAO,CAAG,+CAAE,CAAG,EAAE,6CAAC,CAAC,AACjB,WAAW,CAAE,IAAI,CACjB,OAAO,CAAE,CAAC,CACV,MAAM,CAAE,CAAC,CACT,MAAM,CAAE,IAAI,CACZ,OAAO,CAAE,YAAY,CACrB,UAAU,CAAE,IAAI,AAClB,CAAC,AACD,qCAAO,CAAG,gCAAE,CAAG,gCAAE,CAAG,OAAO,8BAAC,CAAC,AAC3B,WAAW,CAAE,IAAI,CACjB,OAAO,CAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,CACnB,OAAO,CAAE,YAAY,CACrB,eAAe,CAAE,IAAI,CACrB,aAAa,CAAE,KAAK,AACtB,CAAC,AACD,MAAM,AAAC,YAAY,KAAK,CAAC,AAAC,CAAC,AACzB,qCAAO,CAAG,gCAAE,CAAG,gCAAE,CAAG,OAAO,8BAAC,CAAC,AAC3B,WAAW,CAAE,IAAI,AACnB,CAAC,AACH,CAAC,AACD,sBAAO,CAAG,iBAAE,CAAG,iBAAE,CAAG,sBAAO,CAAG,CAAC,eAAC,CAAC,AAC/B,SAAS,CAAE,IAAI,AACjB,CAAC;AC3HD,cAAc,4BAAC,CAAC,AACd,QAAQ,CAAE,KAAK,CACf,IAAI,CAAE,CAAC,CACP,MAAM,CAAE,KAAK,CACb,KAAK,CAAE,IAAI,CACX,MAAM,CAAE,IAAI,CACZ,OAAO,CAAE,IAAI,CACb,WAAW,CAAE,MAAM,CACnB,eAAe,CAAE,MAAM,CACvB,UAAU,CAAE,IAAI,CAChB,UAAU,CAAE,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAC3C,SAAS,CAAE,IAAI,CACf,UAAU,CAAE,MAAM,CAAC,KAAK,CACxB,KAAK,CAAE,IAAI,AACb,CAAC,AACD,cAAc,GAAG,4BAAC,CAAC,AACjB,MAAM,CAAE,CAAC,AACX,CAAC,AACD,4BAAc,CAAC,MAAM,cAAC,CAAC,AACrB,QAAQ,CAAE,QAAQ,CAClB,GAAG,CAAE,CAAC,CACN,KAAK,CAAE,IAAI,CACX,KAAK,CAAE,IAAI,CACX,MAAM,CAAE,IAAI,CACZ,UAAU,CAAE,IAAI,kSAAkS,CAAC,CAAC,SAAS,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CACjV,WAAW,CAAE,KAAK,CAClB,QAAQ,CAAE,MAAM,CAChB,MAAM,CAAE,CAAC,CAAC,IAAI,AAChB,CAAC;AC8HD,KAAK,eAAC,CAAC,AACL,QAAQ,CAAE,QAAQ,AACpB,CAAC"
}